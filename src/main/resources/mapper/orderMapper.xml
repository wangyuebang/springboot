<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wyb.winter.mapper.OrderMapper">

    <!--定义orderMap映射-->
    <resultMap id="orderMap" type="User">
        <id column="id" property="id"/>
        <result column="username" property="username"/>
        <result column="phone" property="phone"/>
        <association property="commodity" javaType="Commodity">
            <id property="uid" column="uid"/>
            <result property="attribute" column="attribute"/>
            <result property="CommodityName" column="CommodityName"/>
        </association>
        <association property="trolley" javaType="Trolley">
            <id property="tuid" column="tuid"/>
            <result property="express" column="express"/>
            <result property="amount" column="amount"/>
            <result property="status" column="status"/>
            <result property="orderDate" column="orderDate"/>
            <result property="deliveryTime" column="deliveryTime"/>
        </association>
    </resultMap>

    <!--查询全部-->
    <select id="getUserOrder" resultMap="orderMap" ><![CDATA[
        SELECT
        u.username, u.phone,
         c.CommodityName, c.attribute,
         t.express, t.amount, t.status, t.orderDate, t.deliveryTime
          FROM
          user u, commodity c, trolley t
          WHERE u.id = c.uid AND u.id = t.tuid
    ]]></select>


    <!--id查询单个订单-->
    <select id="getOrderOne" resultMap="orderMap"><![CDATA[
     SELECT u.username, u.phone,
          c.CommodityName, c.attribute,
          t.express, t.amount, t.status, t.orderDate, t.deliveryTime
     FROM
     user u,  commodity c, trolley t
     WHERE u.id = c.uid AND c.uid = #{c.uid}
     GROUP BY u.username
    ]]></select>

<!--    <update id="updateUserOrder" parameterMap="orderMap"><![CDATA[-->
<!--        UPDATE-->
<!--	        user u-->
<!--        JOIN-->
<!--	        commodity c-->
<!--        ON  u.id = c.uid-->
<!--        AND-->
<!--	        c.uid = #{uid}-->
<!--        SET-->
<!--	        u.username = #{username}, u.phone=#{phone},-->
<!--	        c.attribute=#{attribute}, c.CommodityName = #{CommodityName}-->
<!--    ]]></update>-->


</mapper>